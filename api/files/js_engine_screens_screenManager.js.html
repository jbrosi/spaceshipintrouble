<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js\engine\screens\screenManager.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/engine.entity.Entity.html">engine.entity.Entity</a></li>
            
                <li><a href="../classes/engine.entity.EntityComponent.html">engine.entity.EntityComponent</a></li>
            
                <li><a href="../classes/engine.entity.EntityManager.html">engine.entity.EntityManager</a></li>
            
                <li><a href="../classes/engine.entity.EntityMessage.html">engine.entity.EntityMessage</a></li>
            
                <li><a href="../classes/engine.entity.EntityPrototype.html">engine.entity.EntityPrototype</a></li>
            
                <li><a href="../classes/engine.entity.EntityScript.html">engine.entity.EntityScript</a></li>
            
                <li><a href="../classes/engine.GameInitializer.html">engine.GameInitializer</a></li>
            
                <li><a href="../classes/engine.helper.Box2DHelper.html">engine.helper.Box2DHelper</a></li>
            
                <li><a href="../classes/engine.helper.KeyboardHelper.html">engine.helper.KeyboardHelper</a></li>
            
                <li><a href="../classes/engine.helper.PerformanceTimer.html">engine.helper.PerformanceTimer</a></li>
            
                <li><a href="../classes/engine.helper.StatsHelper.html">engine.helper.StatsHelper</a></li>
            
                <li><a href="../classes/engine.helper.TextHelper.html">engine.helper.TextHelper</a></li>
            
                <li><a href="../classes/engine.helper.VirtualJoystick.html">engine.helper.VirtualJoystick</a></li>
            
                <li><a href="../classes/engine.map.AbstractMapLoader.html">engine.map.AbstractMapLoader</a></li>
            
                <li><a href="../classes/engine.map.MapLayer.html">engine.map.MapLayer</a></li>
            
                <li><a href="../classes/engine.map.MapObject.html">engine.map.MapObject</a></li>
            
                <li><a href="../classes/engine.map.TiledJSONMapLoader.html">engine.map.TiledJSONMapLoader</a></li>
            
                <li><a href="../classes/engine.map.TiledMap.html">engine.map.TiledMap</a></li>
            
                <li><a href="../classes/engine.map.TileSet.html">engine.map.TileSet</a></li>
            
                <li><a href="../classes/engine.screens.AbstractScreen.html">engine.screens.AbstractScreen</a></li>
            
                <li><a href="../classes/engine.screens.LoadLevelScreen.html">engine.screens.LoadLevelScreen</a></li>
            
                <li><a href="../classes/engine.screens.PlayLevelScreen.html">engine.screens.PlayLevelScreen</a></li>
            
                <li><a href="../classes/engine.screens.Screenmanager.html">engine.screens.Screenmanager</a></li>
            
                <li><a href="../classes/engine.util.ResourceLoader.html">engine.util.ResourceLoader</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js\engine\screens\screenManager.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define([&quot;require&quot;, &quot;exports&quot;, &#x27;engine/screens/abstractScreen&#x27;, &#x27;engine/helper/statsHelper&#x27;, &#x27;engine/helper/performanceTimer&#x27;, &#x27;q&#x27;, &#x27;lodash&#x27;], function(require, exports, AbstractScreen, statsHelper, performanceTimer, Q, _) {
    /**
    * Manages all the screens shown. You may stack multiple screens.
    *
    * @namespace engine.screens
    * @class Screenmanager
    */
    var ScreenManager = (function () {
        /**
        * Creates a new &#x60;ScreenManager&#x60;
        *
        * @method __constructor
        */
        function ScreenManager() {
            this._screenStack = [];
            this._isRendering = false;
            _.bindAll(this);
        }
        /**
        * Initializes the &#x60;ScreenManager&#x60; with the given ThreeJS-&#x60;renderer&#x60;
        *
        * @method init
        * @param renderer {THREE.Renderer} the renderer to use in all the screens
        */
        ScreenManager.prototype.init = function (renderer) {
            this._renderer = renderer;
        };

        /**
        * Starts rendering of the screens. This will start a requestAnimationFrame-loop until there
        * is no more screen left to show or until you call &#x60;stopRendering&#x60;.
        *
        * @method startRendering
        */
        ScreenManager.prototype.startRendering = function () {
            if (this._currentScreen &amp;&amp; !this._isRendering) {
                this._isRendering = true;
                requestAnimationFrame(this._render);
            }
        };

        /**
        * Stops a previously invoked &#x60;startRendering&#x60;. No more screens will be rendered after calling this.
        * Call &#x60;startRendering&#x60; again to continue with rendering.
        *
        * @method stopRendering
        */
        ScreenManager.prototype.stopRendering = function () {
            this._isRendering = false;
        };

        /**
        * Load and create a screen with the given &#x60;screenName&#x60;. Returns a promise for the loaded screen
        *
        * @method createScreen
        * @param screenName {string} name of the screen to be loaded
        * @returns {Promise(AbstractScreen)} promise for the loaded screen
        */
        ScreenManager.prototype.createScreen = function (screenName) {
            console.log(&quot;trying to create screen&quot;);
            var deferred = Q.defer();
            var that = this;
            require([&#x27;game/screens/&#x27; + screenName], function (Screen) {
                console.log(&quot;Creating Screen &quot; + screenName);
                deferred.resolve(new Screen(that._renderer));
            });
            return deferred.promise;
        };

        /**
        * Drops the given &#x60;screen&#x60;. If it&#x27;s the current top screen the one beneath it will get the current screen.
        *
        * @method dropScreen
        * @param screen {AbstractScreen} the screen to be dropped
        */
        ScreenManager.prototype.dropScreen = function (screen) {
            if (screen === this._currentScreen) {
                this._screenStack.pop();

                if (this._screenStack.length &gt; 0) {
                    this._currentScreen = this._screenStack[this._screenStack.length - 1];
                } else {
                    this._currentScreen = null;
                }
            }
        };

        /**
        * Makes the given &#x60;screen&#x60; the current one and adds it to the top of the screen stack
        *
        * @method showScreen
        * @param screen {AbstractScreen} the screen to be shown
        */
        ScreenManager.prototype.showScreen = function (screen) {
            console.log(&quot;showing screen...&quot;);
            this._currentScreen = screen;
            this._screenStack.push(this._currentScreen);
            this._currentScreen.show();
            this.startRendering();
        };

        /**
        * Loads and shows a screen by &#x60;screenName&#x60;
        *
        * @method showScreenByName
        * @param screenName {string} the screen to be loaded and shown
        * @returns Promise for the screen when it&#x27;s loaded and shown
        */
        ScreenManager.prototype.showScreenByName = function (screenName) {
            var that = this;

            var deferred = Q.defer();

            require([&#x27;game/screens/&#x27; + screen], function (Screen) {
                that.showScreen(new Screen(this._renderer));
                deferred.resolve(that);
            });

            return deferred.promise;
        };

        /**
        * Internal method for rendering the currentScreen
        *
        * @method _render
        * @private
        */
        ScreenManager.prototype._render = function () {
            if (!this._currentScreen) {
                console.log(&quot;no active screen - stopping rendering&quot;);
                this.stopRendering();
                return;
            }

            statsHelper.begin();

            //render current screen
            this._currentTime = performanceTimer();
            this._timeDiff = this._currentTime - this._lastTime;
            this._lastTime = this._currentTime;

            if (this._timeDiff &gt; 60) {
                this._timeDiff = 60; //max
            }

            this._currentScreen.render(this._timeDiff);

            if (this._isRendering) {
                requestAnimationFrame(this._render);
            }
            statsHelper.end();
        };
        return ScreenManager;
    })();
    ;

    
    return ScreenManager;
});
//# sourceMappingURL=screenManager.js.map

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
